!function(t){function i(i,s,n){this.init=function(i,s,n){this.$obj=t(i),this.url=s,this.opts=n,this.offset=this.opts.offset,this.deploy()},this.deploy=function(){t(window).bind("scroll",t.proxy(this.scroll,this)),t(this.opts.hide).hide()},this.isDataNeeded=function(){return t(window).scrollTop()>=t(document).height()-t(window).height()*this.opts.prediction},this.isDataOver=function(){return 1==this.nodata},this.isLoading=function(){return 1==this.loading},this.load=function(){this.offset+=this.opts.count,this.loading=!0,t.ajax({url:this.url.replace("{offset}",this.offset).replace("{count}",this.opts.count),context:this}).always(function(t,i,s){this.loading=!1,"success"==i&&t.length?(this.$obj.append(t),this.opts.onload.call(this,this.$obj,t)):(this.nodata=!0,this.opts.onend.call(this,this.$obj))})},this.scroll=function(){!this.isDataNeeded()||this.isDataOver()||this.isLoading()||this.load()},this.init(i,s,n)}t.fn.infinite=function(s,n){var o={hide:".pages,.pager,.perpage",count:1,offset:0,onload:function(){},onend:function(){},prediction:2},h=t.extend(o,n);return this.each(function(){t(this).data("infinite",new i(this,s,h))})}}(jQuery);